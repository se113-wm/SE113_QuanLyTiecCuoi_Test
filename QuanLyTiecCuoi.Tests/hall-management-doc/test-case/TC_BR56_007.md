# Test Case TC_BR56_007

## Verify export handles special characters in hall names

| Test Case ID | Test Case Description                                  | PreRequisites                                                                                                           | Steps | Steps to Perform                                                                                                      | Step Expected Result                                                                                               | Test Case Expected Result                                             | Actual Result | Status | Note |
| ------------ | ------------------------------------------------------ | ----------------------------------------------------------------------------------------------------------------------- | ----- | --------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------ | --------------------------------------------------------------------- | ------------- | ------ | ---- |
| TC_BR56_007  | Verify export handles special characters in hall names | 1. WMS application is installed<br>2. User is logged in<br>3. Hall with Vietnamese name exists (e.g., "Sảnh Ánh Trăng") | 4     | 1. Verify Vietnamese named hall in list<br>2. Export to Excel<br>3. Open exported file<br>4. Check hall name encoding | 1. "Sảnh Ánh Trăng" visible<br>2. Export completed<br>3. File opened<br>4. Name displays correctly with diacritics | Export correctly handles Vietnamese characters and special diacritics |               |        |      |

---

## Test Case Details

### Basic Information

| Attribute          | Value                     |
| ------------------ | ------------------------- |
| **Test Case ID**   | TC_BR56_007               |
| **Requirement ID** | BR56                      |
| **Use Case**       | UC 2.1.3.5 - Export Halls |
| **Test Type**      | Functional / Encoding     |
| **Priority**       | High                      |
| **Automation**     | Manual                    |

### Character Encoding Test Cases

| Hall Name            | Characters Tested |
| -------------------- | ----------------- |
| Sảnh Ánh Trăng       | ả, Á, ă           |
| Đại Sảnh Kim Cương   | Đ, ả, ư           |
| Hội Trường Ngọc Bích | ộ, ư              |
| Sảnh Hồng Ngọc       | ả, ồ              |

### ClosedXML Encoding

```csharp
// ClosedXML handles UTF-8 encoding automatically
worksheet.Cell(row, 2).Value = hall.HallName;  // Unicode supported
```

### Detailed Steps

| Step | Steps to Perform                     | Step Expected Result         |
| ---- | ------------------------------------ | ---------------------------- |
| 1    | Verify Vietnamese named hall in list | "Sảnh Ánh Trăng" visible     |
| 2    | Export to Excel                      | Export completed             |
| 3    | Open exported file                   | File opened                  |
| 4    | Check hall name encoding             | Diacritics display correctly |

### Pass/Fail Criteria

| Criteria          | Pass                | Fail            |
| ----------------- | ------------------- | --------------- |
| Unicode preserved | ✓ All chars correct | ✗ Garbled text  |
| Diacritics shown  | ✓ ă, ê, ư visible   | ✗ Missing marks |
| No data loss      | ✓ Complete names    | ✗ Truncated     |
