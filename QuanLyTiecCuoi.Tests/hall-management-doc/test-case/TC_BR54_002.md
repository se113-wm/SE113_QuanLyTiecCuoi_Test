# Test Case TC_BR54_002

## Verify SaveFileDialog opens for file path selection

| Test Case ID | Test Case Description                               | PreRequisites                                                                  | Steps | Steps to Perform                                                                              | Step Expected Result                                                                                        | Test Case Expected Result                                                  | Actual Result | Status | Note |
| ------------ | --------------------------------------------------- | ------------------------------------------------------------------------------ | ----- | --------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------- | ------------- | ------ | ---- |
| TC_BR54_002  | Verify SaveFileDialog opens for file path selection | 1. WMS application is installed<br>2. User is logged in<br>3. HallView is open | 3     | 1. Click Export button<br>2. Observe dialog appearance<br>3. Verify SaveFileDialog properties | 1. Export initiated<br>2. SaveFileDialog opens<br>3. Filter = "Excel Files (\*.xlsx)", DefaultExt = ".xlsx" | SaveFileDialog opens allowing user to select export file location and name |               |        |      |

---

## Test Case Details

### Basic Information

| Attribute          | Value                     |
| ------------------ | ------------------------- |
| **Test Case ID**   | TC_BR54_002               |
| **Requirement ID** | BR54                      |
| **Use Case**       | UC 2.1.3.5 - Export Halls |
| **Test Type**      | Functional / Dialog       |
| **Priority**       | High                      |
| **Automation**     | Manual                    |

### SaveFileDialog Configuration

```csharp
var saveFileDialog = new SaveFileDialog
{
    Filter = "Excel Files (*.xlsx)|*.xlsx",
    DefaultExt = ".xlsx",
    FileName = "DanhSachSanh_" + DateTime.Now.ToString("yyyyMMdd"),
    Title = "Export danh sách sảnh"
};
```

### Detailed Steps

| Step | Steps to Perform                 | Step Expected Result                 |
| ---- | -------------------------------- | ------------------------------------ |
| 1    | Click Export button              | Export initiated                     |
| 2    | Observe dialog appearance        | SaveFileDialog opens                 |
| 3    | Verify SaveFileDialog properties | Correct filter and default extension |

### Pass/Fail Criteria

| Criteria       | Pass              | Fail           |
| -------------- | ----------------- | -------------- |
| Dialog opens   | ✓ Visible         | ✗ Not shown    |
| Filter correct | ✓ \*.xlsx only    | ✗ Wrong filter |
| Default name   | ✓ Has date suffix | ✗ Generic name |
