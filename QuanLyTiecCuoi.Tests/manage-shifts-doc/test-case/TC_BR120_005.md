# Test Case TC_BR120_005

## Verify time format "HH:mm" in Excel

| Test Case ID | Test Case Description               | PreRequisites                                                                                                    | Steps | Steps to Perform                                                                                                                         | Step Expected Result                                                                                                                              | Test Case Expected Result               | Actual Result | Status | Note |
| ------------ | ----------------------------------- | ---------------------------------------------------------------------------------------------------------------- | ----- | ---------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------- | ------------- | ------ | ---- |
| TC_BR120_005 | Verify time format "HH:mm" in Excel | 1. WMS application is installed<br>2. User is logged in (Staff/Admin)<br>3. Shift "Ca Sáng" (08:00-12:00) exists | 5     | 1. Navigate to ShiftView<br>2. Select "Xuất Excel" from SelectedAction<br>3. Click Export button<br>4. Save file<br>5. Check time values | 1. ShiftView displayed<br>2. Export mode activated<br>3. Export clicked<br>4. File saved<br>5. StartTime="08:00", EndTime="12:00" in HH:mm format | Times are formatted as "HH:mm" in Excel |               |        |      |

---

## Test Case Details

### Basic Information

| Attribute          | Value                                |
| ------------------ | ------------------------------------ |
| **Test Case ID**   | TC_BR120_005                         |
| **Requirement ID** | BR120                                |
| **Use Case**       | UC 2.1.3.25 - Export Shifts to Excel |
| **Test Type**      | Functional / Data Format             |
| **Priority**       | High                                 |
| **Automation**     | Manual                               |

### Time Format

```csharp
// TimeSpan to string format
worksheet.Cell(row, 2).Value = shift.StartTime.ToString(@"HH\:mm");
worksheet.Cell(row, 3).Value = shift.EndTime.ToString(@"HH\:mm");
```

### Expected Format Examples

| Shift   | StartTime | EndTime |
| ------- | --------- | ------- |
| Ca Sáng | 08:00     | 12:00   |
| Ca Trưa | 12:00     | 18:00   |
| Ca Tối  | 18:00     | 22:00   |

### Detailed Steps

| Step | Steps to Perform                        | Step Expected Result                               |
| ---- | --------------------------------------- | -------------------------------------------------- |
| 1    | Navigate to ShiftView                   | ShiftView displayed                                |
| 2    | Select "Xuất Excel" from SelectedAction | Export mode activated                              |
| 3    | Click Export button                     | Export clicked                                     |
| 4    | Save file                               | File saved                                         |
| 5    | Check time values                       | StartTime="08:00", EndTime="12:00" in HH:mm format |

### Pass/Fail Criteria

| Criteria        | Pass             | Fail           |
| --------------- | ---------------- | -------------- |
| Format HH:mm    | ✓ Two digits     | ✗ Wrong format |
| Leading zeros   | ✓ 08:00 not 8:00 | ✗ Missing      |
| Colon separator | ✓ Present        | ✗ Missing      |
